---
title: "Brodeur-2018"
format: html
---

## Libraries and data loading

Load libraries.

```{r}
#| label: libraries
#| message: false
#| code-fold: true
#| code-summary: "Click to expand code"

library(tidyverse)
library(fixest)
library(knitr)
library(htmltools)

```

Load data.

```{r}
#| label: dataload
#| message: false
#| code-fold: true
#| code-summary: "Click to expand code"

load("C:/Users/dhub1/RStudioProjects/Brodeur-2018/Brodeur (2018).RData")
variable_table <- read_csv("variable_table.csv")
```

Check data (in Console) and open variable_table

```{r}
#| label: datacheck
#| include: false
#| code-fold: true
#| code-summary: "Click to expand code"

str(df)
glimpse(df)
summary(df)
# View(variable_table)
# View(df)
df %>%
  summarise(
    n_years = n_distinct(year),
    n_fips  = n_distinct(fips)
    )

```

## Replication of Figure 1

```{r}
#| label: figure1
#| code-fold: true
#| code-summary: "Click to expand code"

# identify years with attack(s) within fips
attack_years <- df %>%
  arrange(fips, year) %>%
  group_by(fips) %>%
  mutate(
    lead_post      = dplyr::lead(post),
    is_attack_year = (post == 0) & (lead_post == 1)
  ) %>%
  ungroup() %>%
  filter(is_attack_year)

# number of events
yearly_table <- attack_years %>%
  group_by(year, successful1) %>%
  summarise(count_events = sum(meventperyear), na.rm = TRUE, .groups = "drop") %>%
  # for ggplot color scale
  mutate(successful1 = as.character(successful1)) %>%
  arrange(year, successful1)

# the plot
ggplot(yearly_table, aes(x = year, y = count_events, color = factor(successful1))) +
  geom_line(linewidth = 1) +
  geom_point(size = 1.5) +
  scale_color_manual(
    values = c("0" = "#2ECC71", "1" = "#E74C3C"),
    labels = c("0" = "failed", "1" = "successful"),
    breaks = c("1", "0")
  ) +
  scale_y_continuous(limits = c(0, NA)) +
  labs(
    title = "Figure 1: Number of counties with successful or failed attacks",
    x = "Jahr",
    y = "Number of counties",
    color = "Attack",
    caption = "Brodeur 2018: his Figure 1 is similar but with different numbers"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 12, hjust = 0.5),
    axis.title = element_text(size = 10),
    legend.position = "bottom"
  )

```

## Replication of table 6

### Create the models

```{r}
#| label: table6Models
#| message: false
#| code-fold: true
#| code-summary: "Click to expand code"

df_sub <- df %>%
  filter(!is.na(successful))

# Panel A – Brodeur Table 6
m6A1 <- feols(
  ln_emp_pop ~ post + meventperyear |
    fips + year + month,
  cluster = ~fips, data = df_sub
)

m6A2 <- feols(
  ln_emp_pop ~ successful + post + meventperyear |
    fips + year + month,
  cluster = ~fips, data = df_sub
)

m6A3 <- feols(
  ln_emp_pop ~ successful + post + meventperyear |
    fips + year + month + non_us_t + int_l,
  cluster = ~fips, data = df_sub
)

m6A4 <- feols(
  ln_emp_pop ~ successful + post + meventperyear |
    fips + year + month + non_us_t + int_l +
    aa_assass + aa_armed + aa_bomb + aa_facility +
    ww_firearm + ww_explo + ww_incend,
  cluster = ~fips, data = df_sub
)

m6A5 <- feols(
  ln_emp_pop ~ successful + post + meventperyear |
    fips + month^year + non_us_t + int_l +
    aa_assass + aa_armed + aa_bomb + aa_facility +
    ww_firearm + ww_explo + ww_incend,
  cluster = ~fips, data = df_sub
)

m6A6 <- feols(
  ln_emp_pop ~ successful + post + meventperyear |
    fips + month^year + div_9_all^year + non_us_t + int_l +
    aa_assass + aa_armed + aa_bomb + aa_facility +
    ww_firearm + ww_explo + ww_incend,
  cluster = ~fips, data = df_sub
)


# Panel B
m6B1 <- feols(
  ln_real_qp1_pop ~ post + meventperyear |
    fips + year + month,
  cluster = ~fips, data = df_sub
)

m6B2 <- feols(
  ln_real_qp1_pop ~ successful + post + meventperyear |
    fips + year + month,
  cluster = ~fips, data = df_sub
)

m6B3 <- feols(
  ln_real_qp1_pop ~ successful + post + meventperyear |
    fips + year + month + non_us_t + int_l,
  cluster = ~fips, data = df_sub
)

m6B4 <- feols(
  ln_real_qp1_pop ~ successful + post + meventperyear |
    fips + year + month + non_us_t + int_l +
    aa_assass + aa_armed + aa_bomb + aa_facility +
    ww_firearm + ww_explo + ww_incend,
  cluster = ~fips, data = df_sub
)

m6B5 <- feols(
  ln_real_qp1_pop ~ successful + post + meventperyear |
    fips + month^year + non_us_t + int_l +
    aa_assass + aa_armed + aa_bomb + aa_facility +
    ww_firearm + ww_explo + ww_incend,
  cluster = ~fips, data = df_sub
)

m6B6 <- feols(
  ln_real_qp1_pop ~ successful + post + meventperyear |
    fips + month^year + div_9_all^year + non_us_t + int_l +
    aa_assass + aa_armed + aa_bomb + aa_facility +
    ww_firearm + ww_explo + ww_incend,
  cluster = ~fips, data = df_sub
)


# Panel C
m6C1 <- feols(
  ln_real_qp1_job ~ post + meventperyear |
    fips + year + month,
  cluster = ~fips, data = df_sub
)

m6C2 <- feols(
  ln_real_qp1_job ~ successful + post + meventperyear |
    fips + year + month,
  cluster = ~fips, data = df_sub
)

m6C3 <- feols(
  ln_real_qp1_job ~ successful + post + meventperyear |
    fips + year + month + non_us_t + int_l,
  cluster = ~fips, data = df_sub
)

m6C4 <- feols(
  ln_real_qp1_job ~ successful + post + meventperyear |
    fips + year + month + non_us_t + int_l +
    aa_assass + aa_armed + aa_bomb + aa_facility +
    ww_firearm + ww_explo + ww_incend,
  cluster = ~fips, data = df_sub
)

m6C5 <- feols(
  ln_real_qp1_job ~ successful + post + meventperyear |
    fips + month^year + non_us_t + int_l +
    aa_assass + aa_armed + aa_bomb + aa_facility +
    ww_firearm + ww_explo + ww_incend,
  cluster = ~fips, data = df_sub
)

m6C6 <- feols(
  ln_real_qp1_job ~ successful + post + meventperyear |
    fips + month^year + div_9_all^year + non_us_t + int_l +
    aa_assass + aa_armed + aa_bomb + aa_facility +
    ww_firearm + ww_explo + ww_incend,
  cluster = ~fips, data = df_sub
)

```

### Create table 6

```{r}
#| label: tableCommons
#| code-fold: true
#| code-summary: "Click to expand code"

# define common table properties
dict_common <- c(
  post = "Post-attack",
  successful = "Successful attack",
  meventperyear = "Multiple events per year",
  non_us_t = "Non-US target",
  int_l = "International attack",
  aa_assass = "Assassination",
  aa_armed = "Armed assault",
  aa_bomb = "Bombing",
  aa_facility = "Facility attack",
  ww_firearm = "Firearm",
  ww_explo = "Explosives",
  ww_incend = "Incendiary"
)

order_common <- c(
  "%successful", "%post", "%meventperyear",
  "%non_us_t", "%int_l",
  "%aa_assass", "%aa_armed", "%aa_bomb", "%aa_facility",
  "%ww_firearm", "%ww_explo", "%ww_incend"
)

```

#### Table 6, Panel A: Employment (ln_emp_pop)

```{r}
#| label: Table6PanelA
#| message: false
#| code-fold: true
#| code-summary: "Click to expand code"

tab6A <- etable(list(m6A1, m6A2, m6A3, m6A4, m6A5, m6A6),
       se.below = TRUE,
       signif.code = c("***"=0.01,"**"=0.05,"*"=0.10," "=1),
       dict = dict_common, order = order_common, digits = 3,
       drop = "Intercept", fitstat = ~n + r2, tex = FALSE)

## for rendering: knitr...  for interactive: html_print...
knitr::kable(tab6A, format = "pipe")
# html_print(HTML(kable(tab6A, "html")))

```

#### Table 6, Panel B: Earnings (ln_real_qp1_pop)

```{r}
#| label: Table6PanelB
#| message: false
#| code-fold: true
#| code-summary: "Click to expand code"

tab6B <- etable(list(m6B1, m6B2, m6B3, m6B4, m6B5, m6B6),
       se.below = TRUE,
       signif.code = c("***"=0.01,"**"=0.05,"*"=0.10," "=1),
       dict = dict_common, order = order_common, digits = 3,
       drop = "Intercept", fitstat = ~n + r2, tex = FALSE)

## for rendering: knitr...  for interactive: html_print...
knitr::kable(tab6B, format = "pipe")
# html_print(HTML(kable(tab6B, "html")))

```

#### Table 6, Panel C: Wages (ln_real_qp1_job)

```{r}
#| label: Table6PanelC
#| message: false
#| code-fold: true
#| code-summary: "Click to expand code"

tab6C <- etable(list(m6C1, m6C2, m6C3, m6C4, m6C5, m6C6),
       se.below = TRUE,
       signif.code = c("***"=0.01,"**"=0.05,"*"=0.10," "=1),
       dict = dict_common, order = order_common, digits = 3,
       drop = "Intercept", fitstat = ~n + r2, tex = FALSE)

## for rendering: knitr...  for interactive: html_print...
knitr::kable(tab6C, format = "pipe")
# html_print(HTML(kable(tab6C, "html")))

```

## Replication of table 7

### Create the models

```{r}
#| label: table7Models
#| message: false
#| code-fold: true
#| code-summary: "Click to expand code"

df_sub <- df %>%
  filter(!is.na(successful))

# Table 7 Panel A

m7A1 <- feols(
  ln_emp_manu_pop ~ successful + post + meventperyear |
    fips + year + month,
  cluster = ~fips, data = df_sub
)

m7A2 <- feols(
  ln_emp_manu_pop ~ successful + post + meventperyear |
    fips + non_us_t + int_l + aa_assass + aa_armed + aa_bomb +
    aa_facility + ww_firearm + ww_explo + ww_incend + year + month,
  cluster = ~fips, data = df_sub
)

m7A3 <- feols(
  ln_emp_const_pop ~ successful + post + meventperyear |
    fips + year + month,
  cluster = ~fips, data = df_sub
)

m7A4 <- feols(
  ln_emp_const_pop ~ successful + post + meventperyear |
    fips + non_us_t + int_l + aa_assass + aa_armed + aa_bomb +
    aa_facility + ww_firearm + ww_explo + ww_incend + year + month,
  cluster = ~fips, data = df_sub
)

m7A5 <- feols(
  ln_emp_whole_pop ~ successful + post + meventperyear |
    fips + year + month,
  cluster = ~fips, data = df_sub
)

m7A6 <- feols(
  ln_emp_whole_pop ~ successful + post + meventperyear |
    fips + non_us_t + int_l + aa_assass + aa_armed + aa_bomb +
    aa_facility + ww_firearm + ww_explo + ww_incend + year + month,
  cluster = ~fips, data = df_sub
)


# Table 7 Panel B

m7B1 <- feols(
  ln_emp_retail_pop ~ successful + post + meventperyear |
    fips + year + month,
  cluster = ~fips, data = df_sub
)

m7B2 <- feols(
  ln_emp_retail_pop ~ successful + post + meventperyear |
    fips + non_us_t + int_l + aa_assass + aa_armed + aa_bomb +
    aa_facility + ww_firearm + ww_explo + ww_incend + year + month,
  cluster = ~fips, data = df_sub
)

m7B3 <- feols(
  ln_emp_services_pop ~ successful + post + meventperyear |
    fips + year + month,
  cluster = ~fips, data = df_sub
)

m7B4 <- feols(
  ln_emp_services_pop ~ successful + post + meventperyear |
    fips + non_us_t + int_l + aa_assass + aa_armed + aa_bomb +
    aa_facility + ww_firearm + ww_explo + ww_incend + year + month,
  cluster = ~fips, data = df_sub
)

m7B5 <- feols(
  ln_emp_finance_pop ~ successful + post + meventperyear |
    fips + year + month,
  cluster = ~fips, data = df_sub
)

m7B6 <- feols(
  ln_emp_finance_pop ~ successful + post + meventperyear |
    fips + non_us_t + int_l + aa_assass + aa_armed + aa_bomb +
    aa_facility + ww_firearm + ww_explo + ww_incend + year + month,
  cluster = ~fips, data = df_sub
)


```

### Create table 7

#### Table 7, Panel A: Manufacturing, Construction, Wholesale

```{r}
#| label: Table7PanelA
#| message: false
#| code-fold: true
#| code-summary: "Click to expand code"

tab7A <- etable(list(m7A1, m7A2, m7A3, m7A4, m7A5, m7A6),
       se.below = TRUE,
       signif.code = c("***"=0.01,"**"=0.05,"*"=0.10," "=1),
       dict = dict_common, order = order_common, digits = 3,
       drop = "Intercept", fitstat = ~n + r2, tex = FALSE)

## for rendering: knitr...  for interactive: html_print...
knitr::kable(tab7A, format = "pipe")
# html_print(HTML(kable(tab7A, "html")))

```

#### Table 7, Panel B: Retail trade, Services, Finance and RE

```{r}
#| label: Table7PanelB
#| message: false
#| code-fold: true
#| code-summary: "Click to expand code"

tab7B <- etable(list(m7B1, m7B2, m7B3, m7B4, m7B5, m7B6),
       se.below = TRUE,
       signif.code = c("***"=0.01,"**"=0.05,"*"=0.10," "=1),
       dict = dict_common, order = order_common, digits = 3,
       drop = "Intercept", fitstat = ~n + r2, tex = FALSE)

## for rendering: knitr...  for interactive: html_print...
knitr::kable(tab7B, format = "pipe")
# html_print(HTML(kable(tab7B, "html")))

```

## Replication of table 8

### Create the models

First we have to calculate the ln of the housing index (assuming the variable in the data is the plain index).

```{r}
#| label: table8Models
#| message: false
#| code-fold: true
#| code-summary: "Click to expand code"

df_sub <- df %>%
  filter(!is.na(successful1)) %>% 
  mutate(ln_hh_index = 100 * log(housing_index))

# Panel A – Brodeur Table 6
m8A1 <- feols(
  ln_hh_index ~ post + meventperyear |
    fips + year + month,
  cluster = ~fips, data = df_sub
)

m8A2 <- feols(
  ln_hh_index ~ successful1 + post + meventperyear |
    fips + year + month,
  cluster = ~fips, data = df_sub
)

m8A3 <- feols(
  ln_hh_index ~ successful1 + post + meventperyear |
    fips + year + month + non_us_t + int_l,
  cluster = ~fips, data = df_sub
)

m8A4 <- feols(
  ln_hh_index ~ successful1 + post + meventperyear |
    fips + year + month + non_us_t + int_l +
    aa_assass + aa_armed + aa_bomb + aa_facility +
    ww_firearm + ww_explo + ww_incend,
  cluster = ~fips, data = df_sub
)

m8A5 <- feols(
  ln_hh_index ~ successful1 + post + meventperyear |
    fips + month^year + non_us_t + int_l +
    aa_assass + aa_armed + aa_bomb + aa_facility +
    ww_firearm + ww_explo + ww_incend,
  cluster = ~fips, data = df_sub
)

m8A6 <- feols(
  ln_hh_index ~ successful1 + post + meventperyear |
    fips + month^year + div_9_all^year + non_us_t + int_l +
    aa_assass + aa_armed + aa_bomb + aa_facility +
    ww_firearm + ww_explo + ww_incend,
  cluster = ~fips, data = df_sub
)


```

### Create table 8

#### Table 8, Panel A: ln(house price index)

```{r}
#| label: Table8PanelA
#| message: false
#| code-fold: true
#| code-summary: "Click to expand code"

tab8A <- etable(list(m8A1, m8A2, m8A3, m8A4, m8A5, m8A6),
       se.below = TRUE,
       signif.code = c("***"=0.01,"**"=0.05,"*"=0.10," "=1),
       dict = dict_common, order = order_common, digits = 3,
       drop = "Intercept", fitstat = ~n + r2, tex = FALSE)

## for rendering: knitr...  for interactive: html_print...
knitr::kable(tab8A, format = "pipe")
# html_print(HTML(kable(tab8A, "html")))

```

## Replication Check: Tables 6, 7, and 8

We compared our replication results to those published in Brodeur (2018).\
Overall, our findings are **nearly identical** to the original across all three tables, with only very small differences in standard errors, R² values, and sample size.

### Table 6 (ln_emp_pop)

-   **Successful attack:** Our coefficients (−2.00, −1.98, −2.19, −1.99, −1.82) match Brodeur’s (−1.995, −1.983, −2.191, −1.986, −1.818) almost exactly.\
-   **Post-attack:** Estimates also align perfectly (e.g. −1.09 vs −1.087).\
-   **Standard errors:** Slightly smaller in our replication (0.85–0.90 vs 0.88–0.94).\
-   **R²:** Marginally higher (0.968–0.979 vs 0.965–0.971).

➡️ Substantive interpretation: identical results, slightly stronger significance in our replication.

------------------------------------------------------------------------

### Table 7 (ln_emp_finance_pop)

-   **Successful attack:** Point estimates match perfectly (e.g. −5.06, −5.53, −4.30, −4.90, −4.26, −4.69).\
-   **Post-attack:** Identical coefficients (e.g. 2.51, 2.64, 3.28, 3.81, 3.46, 3.54).\
-   **Standard errors:** Again, somewhat smaller in our replication (1.7–2.1 vs 1.8–2.2). This leads to additional statistical significance in some models.\
-   **R²:** Slightly higher in our replication (0.926–0.952 vs 0.916–0.946).\
-   **Observations:** Almost the same, differing by at most 4 observations across specifications.

➡️ Substantive interpretation: coefficients identical, results fully robust to replication, with slightly stronger statistical evidence.

------------------------------------------------------------------------

### Table 8 (ln_hh_index, housing prices)

-   **Successful attack:** Our coefficients (−1.79, −1.69, −1.70, −2.15, −1.31) match Brodeur’s almost exactly.\
-   **Post-attack:** First column (−2.31) matches perfectly; other estimates (−1.38 to 0.10) are also very close.\
-   **Standard errors:** Slightly smaller in our replication (e.g. 1.01 vs 1.07, 0.69 vs 0.72).\
-   **R²:** Marginally higher (0.946–0.983 vs 0.940–0.976).\
-   **Observations:** Our sample slightly smaller (3,444–3,463 vs 3,465).

➡️ Substantive interpretation: effects on housing prices are reproduced very closely; minor deviations plausibly stem from NA-handling and software.

➡️ **Important note**: The table 8 models are calculated with `successful1` instead of `successful`. This means that the year of the event is regarded as treated. We assume Brodeur has done this because house prices **react faster** than the other economical variables in tables 6 and 7 **and/or** that he knows that the housing index he uses **lags one year** (e.g. not an average over the year but the based on house prices at the end of the year).

------------------------------------------------------------------------

### Visual Summary

|                  | Brodeur (2018)         | Our Replication | Difference       |
|------------------|--------------------|------------------|------------------|
| **Coefficients** | Identical (Tables 6–8) | Identical       | None             |
| **Std. Errors**  | 0.60–2.25              | 0.53–2.13       | Slightly smaller |
| **R²**           | 0.916–0.976            | 0.926–0.983     | Slightly higher  |
| **N**            | \~3,093–4,414          | \~3,089–4,406   | Max −21          |

------------------------------------------------------------------------

**Conclusion:**\
Our replication reproduces Brodeur’s key results across employment, finance, and housing with **remarkable precision**. Differences are limited to slightly smaller standard errors, higher R², and marginally fewer observations, **most likely due to software and NA-handling**. The main findings — negative employment and housing effects of successful terrorist attacks, alongside distinct post-attack dynamics — are **fully confirmed**.

```{r}
#| label: ComparisonTables8
#| message: false
#| code-fold: true
#| code-summary: "Click to expand code"

# Example: Brodeur vs. Replication, Table 8
brodeur_tbl8 <- tibble(
  model = paste0("Col", 1:5),
  successful = c(-1.79, -1.69, -1.70, -2.15, -1.31),
  successful_se = c(1.09, 1.09, 1.02, 1.07, 0.70),
  post = c(-2.31, -1.38, -1.39, -1.09, -0.09),
  post_se = c(0.60, 0.75, 0.73, 0.72, 0.80)
)

rep_tbl8 <- tibble(
  model = paste0("Col", 1:5),
  successful = c(-1.79, -1.69, -1.70, -2.15, -1.31),
  successful_se = c(1.04, 1.04, 0.984, 1.01, 0.665),
  post = c(-2.31, -1.38, -1.39, -1.09, -0.091),
  post_se = c(0.575, 0.717, 0.697, 0.687, 0.756)
)

# Combine for ggplot
plot_df <- bind_rows(
  brodeur_tbl8 %>% mutate(source = "Brodeur (2018)"),
  rep_tbl8 %>% mutate(source = "Replication")
) %>%
  pivot_longer(cols = c(successful, post),
                      names_to = "variable", values_to = "estimate") %>%
  mutate(se = ifelse(variable == "successful", successful_se, post_se))

# Plot
ggplot(plot_df, aes(x = model, y = estimate, color = source)) +
  geom_point(position = position_dodge(width = 0.5)) +
  geom_errorbar(aes(ymin = estimate - 1.96*se,
                    ymax = estimate + 1.96*se),
                width = 0.2, position = position_dodge(width = 0.5)) +
  facet_wrap(~variable, scales = "free_y") +
  labs(
    title = "Table 8: Comparison Brodeur (2018) vs Replication",
    x = "Model specification",
    y = "Coefficient (with 95% CI)"
  ) +
  theme_minimal()

```

## Check assumptions

### How Brodeur addressed the assumptions

**SUTVA / Spillovers**\
- Tests for spillover effects by aggregating to broader Census regions (9 divisions).\
- Finds no significant effects at the regional level → evidence against major spillovers.

**Parallel trends assumption**\
- Event-study analysis with leads (pre-attack years).\
- Pre-coefficients ≈ 0 and statistically insignificant → supports parallel trends.

**No anticipation effects**\
- Design compares successful vs. failed attacks.\
- Since both types of counties experience an attack attempt, and success/failure is only known after the event, anticipation is unlikely to differ systematically between groups.\
- Event-study shows no divergence in pre-periods, reinforcing that anticipation is not a concern.

**No compositional changes**\
- Counties are defined by fixed FIPS codes → no boundary changes.\
- Migration or firm exit would be part of the causal mechanism, not a threat to identification.\
- Robustness checks: restrict sample to counties with a single attack, exclude multiple-event years, etc.

**Exogeneity**\
- Core assumption: success vs. failure of an attack is unrelated to underlying employment trends.\
- Justification: the outcome of an attack (success/failure) is plausibly random ex ante.\
- Supported by the absence of differential pre-trends and the stability of population (no selective out-migration).

**Common shocks**\
- Includes year fixed effects (absorbing nationwide shocks such as recessions) and month fixed effects (seasonality).\
- County fixed effects absorb time-invariant county heterogeneity.\
- Together these control for common macro shocks.

### Our check of the parallel trend assumption

#### Define year of attack (failed or successful)

```{r}
#| label: Year of event
#| code-fold: true
#| code-summary: "Click to expand code"

# Step 1: Get the event year (first 0->1 edge in post) and success status for each county.
ev_info <- df %>%
  arrange(fips, year) %>%
  group_by(fips) %>%
  mutate(is_event_year = (post == 0) & lead(post) == 1) %>%
  summarise(
    event_year  = if (any(is_event_year, na.rm = TRUE)) min(year[is_event_year],
                                                 na.rm = TRUE) else NA_integer_,
    is_success  = if (any(is_event_year, na.rm = TRUE)) as.integer(any(
         successful1[is_event_year] == 1, na.rm = TRUE)) else NA_integer_) %>%
  ungroup()

df_es <- df %>%
  left_join(ev_info, by = "fips") %>%
  filter(!is.na(event_year)) %>%  # keep only fips with an event
  mutate(event_time = year - event_year)

df_es_win <- df_es %>% filter(event_time >= -3, event_time <= 3)

```

#### Plot to check parallel trend assumption

```{r}
#| label: iPlot
#| message: false
#| code-fold: true
#| code-summary: "Click to expand code"

es_mod <- feols(
  ln_emp_pop ~ i(event_time, is_success, ref = -1) | fips + year,
  cluster = ~ fips,
  data = df_es_win)

iplot(es_mod,
      main = "Event study (successful vs failed): parallel-trend check",
      xlab = "Years relative to event (ref = -1)",
      ref.line = 0)
      
# tidy_es <- broom::tidy(es_mod, conf.int = TRUE) %>%
#   filter(str_detect(term, "^event_time::")) %>%
#   mutate(event_time = as.numeric(str_match(term, "event_time::(-?\\d+)")[,2]))

# 
# ggplot(tidy_es, aes(event_time, estimate)) +
#   geom_hline(yintercept = 0, linetype = "dashed", color = "grey50") +
#   geom_point() +
#   geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = .2) +
#   labs(title = "Event study (successful − failed): parallel-trend check",
#        x = "Years relative to event (ref = −1)",
#        y = "Diff-in-diff effect on ln_emp_pop") +
#   theme_minimal()

```

```{r}

# Aggregate data: means for each event_time and is_success
plot_data <- df_es_win %>%
  group_by(event_time, is_success) %>%
  summarise(
    mean_ln_emp_pop = mean(ln_emp_pop, na.rm = TRUE),
    .groups = "drop"
  )

# Make plot
ggplot(plot_data, aes(x = event_time, y = mean_ln_emp_pop, 
                      color = factor(is_success))) +
  geom_line(linewidth = 1) +
  geom_point(size = 2) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "gray50") +
  scale_color_manual(
    values = c("0" = "darkgreen", "1" = "red"),
    labels = c("0" = "Failed", "1" = "Successful"),
    name = "Attack Status"
  ) +
  labs(
    title = "Employment trends: Successful vs Failed attacks",
    x = "Years relative to event",
    y = "Mean log(Employment/Population)"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom")

```

#### Interpretation

The pre-treatment coefficients (t = −3, −2) are close to zero and statistically indistinguishable from zero, supporting the parallel trend assumption.

Starting from t = +1, coefficients turn negative, suggesting that counties experiencing a successful attack face lower employment growth relative to counties with failed attacks, although estimates are imprecisely estimated.

## Robustness of effects

Brodeur presents several robustness checks in **Section IV.C (pp. 270–272)**:

-   **Alternative datasets**: Results hold when using different employment data (BEA instead of CBP data).\
-   **Different windows**: Varying the pre-/post-attack window (e.g. 4 or 5 years pre/post) leaves results unchanged.\
-   **Excluding years**: Dropping one year at a time shows no single year drives results (he did 44 regressions).\
-   **Catastrophic/outlier attacks**: Excluding large events (e.g. 9/11, Oklahoma City bombing) and ambiguous categories (mail-based, hijackings) leaves findings robust → results are not driven by outliers.\
-   **By terrorist group**: Removing specific groups (Islamic, environmental, hate groups, etc.) does not change results.\
-   **Population denominator**: Attacks have no significant effect on population → results reflect employment losses, not migration-driven compositional changes (important as dependent is jobs per population).

**Conclusion:** The results are robust to data source, sample restrictions, exclusion of catastrophic outliers, and alternative specifications.

## Other Studies Brodeur relates to in his paper

In positioning his contribution, Brodeur (2018) relates his work to a growing literature on the economic consequences of terrorism. He highlights the seminal studies by Abadie and Gardeazabal (2003, 2008), which show substantial economic costs of terrorism in the Basque Country and in cross-country settings, as well as Blomberg, Hess, and Orphanides (2004) and Enders and Sandler (2005), who document macroeconomic losses from terrorism. At the regional and sectoral level, Greenbaum, Dugan, and LaFree (2007) and Öcal and Yildirim (2010) study the local economic impacts of terror in Italy and Turkey. Brodeur also notes the literature on mechanisms through which terrorism affects economic outcomes, such as real estate markets (Besley and Mueller 2012; Abadie and Dermisi 2008) and well-being (Frey, Luechinger, and Stutzer 2007).

His study complements this work by exploiting variation between successful and failed attacks at the U.S. county level, providing new micro-level evidence. A complete list of related studies cited in Brodeur (2018) is provided in the Appendix.

## Recent Literature on the Economic Consequences of Terrorism (Post-2018)

Research on the economic effects of terrorism has continued to grow since Brodeur (2018).\
While his study provided micro-level causal evidence for U.S. counties, later work has explored new outcomes (such as inequality and business failures), expanded geographic coverage, and reviewed broader economic mechanisms.\
This shows the continuing interest in understanding how terrorism shapes economies at different levels.

### Selected Studies After 2018

-   **Meierrieks et al. (2025). “The effect of terrorism on economic inequality in democracies.”**\
    Finds that increased terrorist activity is associated with rising income inequality in democracies.\
    [ScienceDirect link](https://www.sciencedirect.com/science/article/pii/S0176268024001423?utm_source=chatgpt.com)

-   **Bardwell & Mohib (2021). “The Economic Impact of Terrorism from 2000 to 2018.”**\
    Uses a cost-accounting approach to estimate global costs of terrorism (deaths, property damage, GDP losses).\
    [De Gruyter link](https://www.degruyterbrill.com/document/doi/10.1515/peps-2020-0031/html?lang=en&srsltid=AfmBOorsQnmkbPkTmSKs5_1Zse2SPNAOumb-Sfibi7GjRCHBpPN5yI0u&utm_source=chatgpt.com)

-   **Tingbani (2019). “Terrorism and country-level global business failure.”**\
    Examines how terrorism affects business failure at the national level.\
    [ScienceDirect link](https://www.sciencedirect.com/science/article/abs/pii/S0148296318304211?utm_source=chatgpt.com)

-   **Sandler (2025). “An Economic Perspective on Terrorism and Counterterrorism.”**\
    Provides a recent overview of the economics of terrorism and counterterrorism policies.\
    [Taylor & Francis link](https://www.tandfonline.com/doi/abs/10.1080/09546553.2023.2259992?utm_source=chatgpt.com)

-   **Brodeur (2022). “On the Economic Consequences of Mass Shootings.”**\
    Extends the logic of his 2018 terrorism study to mass shootings, analyzing their local economic impact.\
    [RePEc link](https://ideas.repec.org/p/zbw/glodps/1133.html?utm_source=chatgpt.com)

### Studies Citing Brodeur (2018)

We have identified two recent studies that explicitly cite Brodeur (2018) and build on his findings regarding the economic consequences of terrorism:

-   **Amarasinghe (2023), “Public sentiment in times of terror,” Journal of Development Economics**
    -   Cites Brodeur (2018) when describing the identification strategy based on successful vs. failed attacks (p. 4).\
    -   Refers to Brodeur’s findings on employment and wages in the related literature section (p. 5).\
    -   [PDF link](https://ashaniamarasinghe.github.io/docs/Public_Sentiment_in_Times_of_Terror.pdf)
-   **Chen (2025), “Rally post-terrorism,” Journal of Population Economics**
    -   References Brodeur (2018) to highlight that successful attacks cause larger economic damage than failed ones (p. 6).\
    -   Mentions Brodeur’s evidence on job losses and adverse business conditions after successful terrorism (p. 22).\
    -   [Springer link](https://link.springer.com/article/10.1007/s00148-025-01106-2)

## Appendix

### Literature cited in Brodeur (2018)

#### Macroeconomic effects

-   Abadie & Gardeazabal (2003) – Basque Country (pp. 246–247)\
-   Abadie & Gardeazabal (2008) – Terrorism and the world economy (pp. 280–281)\
-   Blomberg, Hess & Orphanides (2004) – Macroeconomic consequences of terrorism (pp. 246–247)\
-   Crain & Crain (2006) – Terrorized economies (pp. 246–247, 281)\
-   Enders, Sandler & Parise (1992) – Terrorism and tourism (p. 249)\
-   Enders & Sandler (2005) – After 9/11 (p. 249)\
-   Enders, Sandler & Gaibulloev (2011) – Domestic vs transnational terrorism (p. 249)\
-   Enders, Hoover & Sandler (2016) – Terrorism and growth (p. 246)\
-   Gaibulloev & Sandler (2008) – Growth consequences in Western Europe (p. 246)\
-   Gaibulloev, Sandler & Sul (2014) – Dynamic panel analysis (p. 246)\
-   Gries, Krieger & Meierrieks (2011) – Terrorism and growth (p. 246)\
-   Meierrieks & Gries (2013) – Terrorism and growth (p. 246)\
-   Tavares (2004) – Terrorism and open economies (p. 246)

#### Regional / local effects

-   Öcal & Yildirim (2010) – Turkey (p. 246)\
-   Greenbaum, Dugan & LaFree (2007) – Italy (pp. 246, 282)\
-   Landes (1978) – Aircraft hijacking (p. 249)\
-   Ratcliffe & von Hinke (2015) – London bombings (pp. 249, 281)

#### Channels / mechanisms

-   Becker & Murphy (2001) – Uncertainty after terror (p. 246)\
-   Becker & Rubinstein (2011) – Fear and response (pp. 270–271)\
-   Frey, Luechinger & Stutzer (2007) – Costs of terrorism / life satisfaction (pp. 249, 281)\
-   Besley & Mueller (2012) – Violence and house prices (pp. 249, 281)\
-   Glaeser & Shapiro (2002) – Terrorism and urban form (pp. 249, 282)\
-   Abadie & Dermisi (2008) – Terrorism and real estate (p. 280)\
-   Benmelech, Berrebi & Klor (2010, 2012) – Terrorism costs and suicide terrorism (p. 281)

#### Other relevant studies

-   Di Tella & Schargrodsky (2004) – Police after attacks (pp. 249, 281)\
-   Draca, Machin & Witt (2011) – London terror and crime (pp. 249, 281)\
-   Klick & Tabarrok (2005) – Police and terror alert levels (p. 249)\
-   Krueger & Malečková (2003); Krueger (2007) – Causes of terrorism (p. 249)\
-   Mitra, Pham & Bandyopadhyay (2017) – Terror and air passenger transport (p. 281)\
-   Ratcliffe & von Hinke (2015) – London bombings and prejudice (p. 281)
